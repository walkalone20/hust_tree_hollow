from sympy import *

P = 154473589832213361859908639911378844272004743095162278106401193062021795659951532071849611221408114856977541185221777999203649536390600931845532205434681269942981950084952378057613281937884618082618718793461514522053552788509084658746315149814898733866935167152850440008355932708580342659102804510673806870103
Q = 61364982200540699717417359899234303153925401370411671917714048352020951503065544962368442948039784004119744404313794588126790153641387972555270325726021946590302754058870859613392844616307631365768685846770111458918440146667045947991669517764714283111373247442509894551327618182480442215040029463124827365779
N = P * Q
E = 65537
Phi = (P - 1) * (Q - 1)
D = mod_inverse(E, Phi)

# 输入 128 bit 密钥（16位 ASCII 字符）
def Encode(Text):
    Data = 0
    for i in Text:
        Data = (Data << 8) + ord(i)
    return pow(Data, E, N)

def Decode(Cipher):
    Data = pow(Cipher, D, N)
    Text = ""
    for i in range(0, 16):
        Text += chr(Data % 256)
        Data >>= 8
    return Text[::-1]
